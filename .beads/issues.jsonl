{"id":"ruby-bindgen-3c7","title":"Support array member fields via Rice buffers","description":"## Problem\n\nArray member fields like `int idx[MAX_DIM]` in `cv::SparseMat::Node` are not wrapped. The field is silently skipped.\n\n## Root Cause\n\nIn `lib/ruby-bindgen/visitors/rice/rice.rb:1347-1354`:\n\n```ruby\ndef visit_field_decl(cursor)\n  return unless cursor.public?\n\n  # Can't return arrays in C++\n  return if cursor.type.is_a?(::FFI::Clang::Types::Array)\n\n  self.render_cursor(cursor, \"field_decl\")\nend\n```\n\nAll array-type fields are skipped entirely.\n\n## Solution\n\nArray fields should be wrapped using Rice's buffer mechanism, similar to how pointer parameters use `ArgBuffer`/`ReturnBuffer`. The `field_decl.erb` template needs to handle array types specially, generating something like:\n\n```cpp\ndefine_attr(\"idx\", \u0026cv::SparseMat::Node::idx, Rice::AttrAccess::Read)\n```\n\nRice already supports buffer handling per `docs/features.md` - this extends that support to member fields.\n\n## Affected Files\n\n- `lib/ruby-bindgen/visitors/rice/rice.rb` - remove/modify array skip logic\n- `lib/ruby-bindgen/visitors/rice/field_decl.erb` - handle array type output\n\n## Test Case\n\nAdd a class with an array member field to `test/headers/cpp/classes.hpp` and verify it generates correct bindings.","status":"closed","priority":2,"issue_type":"bug","owner":"cfis@savagexi.com","created_at":"2026-01-27T20:41:10.160732318-08:00","created_by":"Charlie Savage","updated_at":"2026-01-27T20:52:14.166456476-08:00","closed_at":"2026-01-27T20:52:14.166456476-08:00","close_reason":"Fixed array field wrapping - removed skip logic, made arrays read-only","dependencies":[{"issue_id":"ruby-bindgen-3c7","depends_on_id":"ruby-bindgen-8x0","type":"blocks","created_at":"2026-01-27T20:42:08.001295111-08:00","created_by":"Charlie Savage"}]}
{"id":"ruby-bindgen-8x0","title":"Add test case for array member fields","description":"Add a test class with array member fields to validate the fix.\n\n## Changes\n\n1. Add to `test/headers/cpp/classes.hpp`:\n```cpp\nclass ArrayFieldTest {\npublic:\n    int fixed_array[3];\n    double matrix[2][2];\n};\n```\n\n2. Verify test fails (field not wrapped) before fix\n3. Update expected bindings after fix is applied","status":"closed","priority":2,"issue_type":"task","owner":"cfis@savagexi.com","created_at":"2026-01-27T20:41:55.676161332-08:00","created_by":"Charlie Savage","updated_at":"2026-01-27T20:52:14.132774613-08:00","closed_at":"2026-01-27T20:52:14.132774613-08:00","close_reason":"Fixed array field wrapping - removed skip logic, made arrays read-only"}
