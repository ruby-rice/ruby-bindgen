{"id":"ruby-bindgen-39t","title":"Update tests for increment_post/decrement_post naming","description":"After fixing the operator naming, update test expected files:\n\n1. Run tests to find failures\n2. Update `test/bindings/cpp/*.cpp` expected files\n3. Verify all tests pass\n\nDepends on the naming fix being applied first.","status":"closed","priority":2,"issue_type":"task","owner":"cfis@savagexi.com","created_at":"2026-01-27T22:07:28.173125092-08:00","created_by":"Charlie Savage","updated_at":"2026-01-27T22:14:51.487426964-08:00","closed_at":"2026-01-27T22:14:51.487426964-08:00","close_reason":"Fixed operator naming: pre=increment/decrement, post=increment_post/decrement_post","dependencies":[{"issue_id":"ruby-bindgen-39t","depends_on_id":"ruby-bindgen-tad","type":"blocks","created_at":"2026-01-27T22:07:46.289349587-08:00","created_by":"Charlie Savage"}]}
{"id":"ruby-bindgen-3c7","title":"Support array member fields via Rice buffers","description":"## Problem\n\nArray member fields like `int idx[MAX_DIM]` in `cv::SparseMat::Node` are not wrapped. The field is silently skipped.\n\n## Root Cause\n\nIn `lib/ruby-bindgen/visitors/rice/rice.rb:1347-1354`:\n\n```ruby\ndef visit_field_decl(cursor)\n  return unless cursor.public?\n\n  # Can't return arrays in C++\n  return if cursor.type.is_a?(::FFI::Clang::Types::Array)\n\n  self.render_cursor(cursor, \"field_decl\")\nend\n```\n\nAll array-type fields are skipped entirely.\n\n## Solution\n\nArray fields should be wrapped using Rice's buffer mechanism, similar to how pointer parameters use `ArgBuffer`/`ReturnBuffer`. The `field_decl.erb` template needs to handle array types specially, generating something like:\n\n```cpp\ndefine_attr(\"idx\", \u0026cv::SparseMat::Node::idx, Rice::AttrAccess::Read)\n```\n\nRice already supports buffer handling per `docs/features.md` - this extends that support to member fields.\n\n## Affected Files\n\n- `lib/ruby-bindgen/visitors/rice/rice.rb` - remove/modify array skip logic\n- `lib/ruby-bindgen/visitors/rice/field_decl.erb` - handle array type output\n\n## Test Case\n\nAdd a class with an array member field to `test/headers/cpp/classes.hpp` and verify it generates correct bindings.","status":"closed","priority":2,"issue_type":"bug","owner":"cfis@savagexi.com","created_at":"2026-01-27T20:41:10.160732318-08:00","created_by":"Charlie Savage","updated_at":"2026-01-27T20:52:14.166456476-08:00","closed_at":"2026-01-27T20:52:14.166456476-08:00","close_reason":"Fixed array field wrapping - removed skip logic, made arrays read-only","dependencies":[{"issue_id":"ruby-bindgen-3c7","depends_on_id":"ruby-bindgen-8x0","type":"blocks","created_at":"2026-01-27T20:42:08.001295111-08:00","created_by":"Charlie Savage"}]}
{"id":"ruby-bindgen-6a7","title":"Replace global $1 regex variables with named captures","description":"Several places use global $1/$2 variables after regex matches:\n\n- Lines 1929, 1955 in `resolve_base_instantiation`\n- Line 668 in `qualify_dependent_types_in_template_args`\n\nThese are fragile - if code changes between match and use of $1, wrong data is captured.\n\nReplace with named captures or inline `match[1]` access.","status":"open","priority":4,"issue_type":"task","owner":"cfis@savagexi.com","created_at":"2026-01-27T21:56:42.968438763-08:00","created_by":"Charlie Savage","updated_at":"2026-01-27T21:56:42.968438763-08:00"}
{"id":"ruby-bindgen-8x0","title":"Add test case for array member fields","description":"Add a test class with array member fields to validate the fix.\n\n## Changes\n\n1. Add to `test/headers/cpp/classes.hpp`:\n```cpp\nclass ArrayFieldTest {\npublic:\n    int fixed_array[3];\n    double matrix[2][2];\n};\n```\n\n2. Verify test fails (field not wrapped) before fix\n3. Update expected bindings after fix is applied","status":"closed","priority":2,"issue_type":"task","owner":"cfis@savagexi.com","created_at":"2026-01-27T20:41:55.676161332-08:00","created_by":"Charlie Savage","updated_at":"2026-01-27T20:52:14.132774613-08:00","closed_at":"2026-01-27T20:52:14.132774613-08:00","close_reason":"Fixed array field wrapping - removed skip logic, made arrays read-only"}
{"id":"ruby-bindgen-adu","title":"skip_symbols should filter template class builders","description":"`cv::MatCommaInitializer_` is in `skip_symbols`, but the generator still creates `MatCommaInitializer__builder`.\n\nThe skip_symbols filter should prevent template class builders from being generated for skipped symbols.","status":"closed","priority":2,"issue_type":"bug","owner":"cfis@savagexi.com","created_at":"2026-01-27T21:08:33.28778776-08:00","created_by":"Charlie Savage","updated_at":"2026-01-27T21:14:27.552641975-08:00","closed_at":"2026-01-27T21:14:27.552641975-08:00","close_reason":"Fixed: skip_symbols now filters template class builders"}
{"id":"ruby-bindgen-b0r","title":"Update increment/decrement naming in mat-rb.cpp manually","description":"After reverting mat-rb.cpp, apply these renames manually:\n\n**Naming change:**\n- `increment_pre` → `increment`\n- `increment` → `increment_post`\n- `decrement_pre` → `decrement`\n- `decrement` → `decrement_post`\n\n**Affected classes (in template builders):**\n- `cv::MatConstIterator_\u003c_Tp\u003e` - increment, increment_post, decrement, decrement_post\n- `cv::MatIterator_\u003c_Tp\u003e` - increment, increment_post, decrement, decrement_post\n- `cv::SparseMatConstIterator_\u003c_Tp\u003e` - increment, increment_post\n- `cv::SparseMatIterator_\u003c_Tp\u003e` - increment, increment_post\n\n**Affected classes (non-template):**\n- `cv::MatConstIterator` - increment, increment_post, decrement, decrement_post\n- `cv::SparseMatConstIterator` - increment, increment_post, decrement, decrement_post\n- `cv::SparseMatIterator` - increment, increment_post\n- `cv::NAryMatIterator` - increment, increment_post\n\nUse find/replace:\n1. `\"increment_pre\"` → `\"increment\"`\n2. `\"increment\"` → `\"increment_post\"` (careful: do after step 1)\n3. `\"decrement_pre\"` → `\"decrement\"`\n4. `\"decrement\"` → `\"decrement_post\"` (careful: do after step 3)","status":"closed","priority":2,"issue_type":"task","owner":"cfis@savagexi.com","created_at":"2026-01-27T22:16:52.887319092-08:00","created_by":"Charlie Savage","updated_at":"2026-01-27T22:19:44.144872924-08:00","closed_at":"2026-01-27T22:19:44.144872924-08:00","close_reason":"Applied naming changes: increment/decrement for pre, increment_post/decrement_post for post"}
{"id":"ruby-bindgen-drn","title":"Make ITERATOR_METHODS configurable","description":"The iterator method names are hardcoded at line 1058:\n\n```ruby\nITERATOR_METHODS = [\"begin\", \"end\", \"cbegin\", \"cend\", \"rbegin\", \"rend\", \"crbegin\", \"crend\"].freeze\n```\n\nShould be configurable via bindings.yaml for:\n- Custom iterator method names\n- Excluding specific iterator methods","status":"open","priority":4,"issue_type":"feature","owner":"cfis@savagexi.com","created_at":"2026-01-27T21:56:49.644356812-08:00","created_by":"Charlie Savage","updated_at":"2026-01-27T21:56:49.644356812-08:00"}
{"id":"ruby-bindgen-dzf","title":"Add recursion depth limits","description":"Recursive methods have no maximum depth limit:\n\n- `copyable_class?` (line 1154) - traverses inheritance chain\n- `auto_generate_base_class` (line 1600) - recursive base generation\n\nDeep or circular inheritance could cause stack overflow.\n\nAdd a max depth parameter with sensible default (e.g., 50).","status":"open","priority":3,"issue_type":"bug","owner":"cfis@savagexi.com","created_at":"2026-01-27T21:56:27.345048991-08:00","created_by":"Charlie Savage","updated_at":"2026-01-27T21:56:27.345048991-08:00"}
{"id":"ruby-bindgen-ij6","title":"Add array field define_attr to mat-rb.cpp manually","description":"After regenerating mat-rb.cpp, these new array field attributes need to be added back manually:\n\n```cpp\n// cv::MatStep\ndefine_attr(\"p\", \u0026cv::MatStep::p).\ndefine_attr(\"buf\", \u0026cv::MatStep::buf, Rice::AttrAccess::Read);\n\n// cv::SparseMat::Hdr\ndefine_attr(\"hashtab\", \u0026cv::SparseMat::Hdr::hashtab).\ndefine_attr(\"size\", \u0026cv::SparseMat::Hdr::size, Rice::AttrAccess::Read);\n\n// cv::SparseMat::Node\ndefine_attr(\"next\", \u0026cv::SparseMat::Node::next).\ndefine_attr(\"idx\", \u0026cv::SparseMat::Node::idx, Rice::AttrAccess::Read);\n```\n\nThese are array fields now supported by ruby-bindgen after the array field fix.","status":"closed","priority":2,"issue_type":"task","owner":"cfis@savagexi.com","created_at":"2026-01-27T21:49:13.936604361-08:00","created_by":"Charlie Savage","updated_at":"2026-01-27T21:51:44.270686063-08:00","closed_at":"2026-01-27T21:51:44.270686063-08:00","close_reason":"Added 3 array field attrs: MatStep::buf, SparseMat::Hdr::size, SparseMat::Node::idx"}
{"id":"ruby-bindgen-mgn","title":"Fix cruby_name collision between global and namespaced types","description":"Global C types and namespaced C++ types can produce the same cruby_name variable:\n- `CvVideoWriter` (global C type) -\u003e `rb_cCvVideoWriter`\n- `cv::VideoWriter` (namespaced C++ class) -\u003e `rb_cCvVideoWriter`\n\n**Proposed fix**: Insert underscore between namespace prefix and class name for namespaced types:\n- `CvVideoWriter` (global) -\u003e `rb_cCvVideoWriter`\n- `cv::VideoWriter` (namespaced) -\u003e `rb_cCv_VideoWriter`\n- `cv::cuda::Stream` -\u003e `rb_cCv_Cuda_Stream`\n\n**Current workaround**: Manually rename the legacy C type variable to `rb_cCvVideoWriterLegacy` in videoio-rb.cpp after regeneration.","status":"open","priority":2,"issue_type":"bug","owner":"cfis@savagexi.com","created_at":"2026-01-27T21:08:23.456564643-08:00","created_by":"Charlie Savage","updated_at":"2026-01-27T21:08:23.456564643-08:00"}
{"id":"ruby-bindgen-n9j","title":"Support cross-file overload detection","description":"Functions like `cv::error` and `cv::randu` have overloads spread across different header files (e.g., `error` in both `base.hpp` and `core.hpp`).\n\nThe current overload detection only finds overloads within a single namespace cursor, missing cross-file overloads.\n\n**Current workaround**: Add these functions to `skip_symbols` in bindings config if they cause compilation errors like \"could not deduce template argument for 'Function_T'\".\n\nThis is a known limitation that would require tracking overloads across translation units.","status":"open","priority":3,"issue_type":"feature","owner":"cfis@savagexi.com","created_at":"2026-01-27T21:08:44.573372649-08:00","created_by":"Charlie Savage","updated_at":"2026-01-27T21:08:44.573372649-08:00"}
{"id":"ruby-bindgen-nog","title":"Update Rice operators.md documentation","description":"Update `/mnt/c/Source/rice/docs/bindings/operators.md`:\n\n1. **Fix increment/decrement table (lines 79-84):**\n   - Change `++a` mapping from `increment_pre` to `increment`\n   - Change `a++` mapping from `increment` to `increment_post`\n   - Change `--a` mapping from `decrement_pre` to `decrement`\n   - Change `a--` mapping from `decrement` to `decrement_post`\n\n2. **Fix logical operators bug (line 73):**\n   - `!` is incorrectly listed as mapping to `decrement_pre`\n   - Should just be `!` (Ruby supports overriding it)\n\nNew table:\n```\n| ++a  | Not overridable  | increment      |\n| a++  | Not overridable  | increment_post |\n| --a  | Not overridable  | decrement      |\n| a--  | Not overridable  | decrement_post |\n```","status":"closed","priority":2,"issue_type":"task","owner":"cfis@savagexi.com","created_at":"2026-01-27T22:07:34.649883882-08:00","created_by":"Charlie Savage","updated_at":"2026-01-27T22:14:51.512666602-08:00","closed_at":"2026-01-27T22:14:51.512666602-08:00","close_reason":"Fixed operator naming: pre=increment/decrement, post=increment_post/decrement_post"}
{"id":"ruby-bindgen-np1","title":"Fix bare rescue clauses in rice.rb","description":"Several bare rescue clauses swallow all exceptions, masking real errors:\n\n1. Line 415-422 `has_export_macro?` - catches all exceptions, returns true\n2. Lines 925, 981 `find_default_value` - catches ArgumentError but may swallow others\n\nShould catch specific exception types or at minimum log/warn on unexpected errors.","status":"open","priority":2,"issue_type":"bug","owner":"cfis@savagexi.com","created_at":"2026-01-27T21:56:14.330214208-08:00","created_by":"Charlie Savage","updated_at":"2026-01-27T21:56:14.330214208-08:00"}
{"id":"ruby-bindgen-sfs","title":"Add null safety checks in rice.rb","description":"Several places access properties without null checks:\n\n1. Line 1504 `visit_template_specialization` - `type_ref.definition` called without checking if type_ref is nil\n2. Line 1572 `auto_generate_base_class` - unsafe array indexing with `\u0026.[](1)`\n3. Lines 168-169 `visit_translation_unit` - unconditional pop after conditional shift\n\nThese could cause NoMethodError crashes on certain inputs.","status":"open","priority":3,"issue_type":"bug","owner":"cfis@savagexi.com","created_at":"2026-01-27T21:56:20.840231515-08:00","created_by":"Charlie Savage","updated_at":"2026-01-27T21:56:20.840231515-08:00"}
{"id":"ruby-bindgen-tad","title":"Fix asymmetric increment/decrement operator naming","description":"The increment/decrement operator naming is confusing:\n\nCurrent:\n- Pre (`++a`): `increment_pre`\n- Post (`a++`): `increment`\n\nShould be (pre-increment is the common case, gets simple name):\n- Pre (`++a`): `increment`\n- Post (`a++`): `increment_post`\n\n**File:** `lib/ruby-bindgen/namer.rb:34-35`\n\n```ruby\n'++' =\u003e -\u003e(cursor) { cursor.type.args_size == 0 ? 'increment' : 'increment_post' },\n'--' =\u003e -\u003e(cursor) { cursor.type.args_size == 0 ? 'decrement' : 'decrement_post' },\n```","status":"closed","priority":2,"issue_type":"bug","owner":"cfis@savagexi.com","created_at":"2026-01-27T22:07:21.745019709-08:00","created_by":"Charlie Savage","updated_at":"2026-01-27T22:14:51.451443156-08:00","closed_at":"2026-01-27T22:14:51.451443156-08:00","close_reason":"Fixed operator naming: pre=increment/decrement, post=increment_post/decrement_post"}
