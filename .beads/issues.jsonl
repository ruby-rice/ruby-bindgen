{"id":"ruby-bindgen-3c7","title":"Support array member fields via Rice buffers","description":"## Problem\n\nArray member fields like `int idx[MAX_DIM]` in `cv::SparseMat::Node` are not wrapped. The field is silently skipped.\n\n## Root Cause\n\nIn `lib/ruby-bindgen/visitors/rice/rice.rb:1347-1354`:\n\n```ruby\ndef visit_field_decl(cursor)\n  return unless cursor.public?\n\n  # Can't return arrays in C++\n  return if cursor.type.is_a?(::FFI::Clang::Types::Array)\n\n  self.render_cursor(cursor, \"field_decl\")\nend\n```\n\nAll array-type fields are skipped entirely.\n\n## Solution\n\nArray fields should be wrapped using Rice's buffer mechanism, similar to how pointer parameters use `ArgBuffer`/`ReturnBuffer`. The `field_decl.erb` template needs to handle array types specially, generating something like:\n\n```cpp\ndefine_attr(\"idx\", \u0026cv::SparseMat::Node::idx, Rice::AttrAccess::Read)\n```\n\nRice already supports buffer handling per `docs/features.md` - this extends that support to member fields.\n\n## Affected Files\n\n- `lib/ruby-bindgen/visitors/rice/rice.rb` - remove/modify array skip logic\n- `lib/ruby-bindgen/visitors/rice/field_decl.erb` - handle array type output\n\n## Test Case\n\nAdd a class with an array member field to `test/headers/cpp/classes.hpp` and verify it generates correct bindings.","status":"closed","priority":2,"issue_type":"bug","owner":"cfis@savagexi.com","created_at":"2026-01-27T20:41:10.160732318-08:00","created_by":"Charlie Savage","updated_at":"2026-01-27T20:52:14.166456476-08:00","closed_at":"2026-01-27T20:52:14.166456476-08:00","close_reason":"Fixed array field wrapping - removed skip logic, made arrays read-only","dependencies":[{"issue_id":"ruby-bindgen-3c7","depends_on_id":"ruby-bindgen-8x0","type":"blocks","created_at":"2026-01-27T20:42:08.001295111-08:00","created_by":"Charlie Savage"}]}
{"id":"ruby-bindgen-8x0","title":"Add test case for array member fields","description":"Add a test class with array member fields to validate the fix.\n\n## Changes\n\n1. Add to `test/headers/cpp/classes.hpp`:\n```cpp\nclass ArrayFieldTest {\npublic:\n    int fixed_array[3];\n    double matrix[2][2];\n};\n```\n\n2. Verify test fails (field not wrapped) before fix\n3. Update expected bindings after fix is applied","status":"closed","priority":2,"issue_type":"task","owner":"cfis@savagexi.com","created_at":"2026-01-27T20:41:55.676161332-08:00","created_by":"Charlie Savage","updated_at":"2026-01-27T20:52:14.132774613-08:00","closed_at":"2026-01-27T20:52:14.132774613-08:00","close_reason":"Fixed array field wrapping - removed skip logic, made arrays read-only"}
{"id":"ruby-bindgen-adu","title":"skip_symbols should filter template class builders","description":"`cv::MatCommaInitializer_` is in `skip_symbols`, but the generator still creates `MatCommaInitializer__builder`.\n\nThe skip_symbols filter should prevent template class builders from being generated for skipped symbols.","status":"closed","priority":2,"issue_type":"bug","owner":"cfis@savagexi.com","created_at":"2026-01-27T21:08:33.28778776-08:00","created_by":"Charlie Savage","updated_at":"2026-01-27T21:14:27.552641975-08:00","closed_at":"2026-01-27T21:14:27.552641975-08:00","close_reason":"Fixed: skip_symbols now filters template class builders"}
{"id":"ruby-bindgen-ij6","title":"Add array field define_attr to mat-rb.cpp manually","description":"After regenerating mat-rb.cpp, these new array field attributes need to be added back manually:\n\n```cpp\n// cv::MatStep\ndefine_attr(\"p\", \u0026cv::MatStep::p).\ndefine_attr(\"buf\", \u0026cv::MatStep::buf, Rice::AttrAccess::Read);\n\n// cv::SparseMat::Hdr\ndefine_attr(\"hashtab\", \u0026cv::SparseMat::Hdr::hashtab).\ndefine_attr(\"size\", \u0026cv::SparseMat::Hdr::size, Rice::AttrAccess::Read);\n\n// cv::SparseMat::Node\ndefine_attr(\"next\", \u0026cv::SparseMat::Node::next).\ndefine_attr(\"idx\", \u0026cv::SparseMat::Node::idx, Rice::AttrAccess::Read);\n```\n\nThese are array fields now supported by ruby-bindgen after the array field fix.","status":"open","priority":2,"issue_type":"task","owner":"cfis@savagexi.com","created_at":"2026-01-27T21:49:13.936604361-08:00","created_by":"Charlie Savage","updated_at":"2026-01-27T21:49:13.936604361-08:00"}
{"id":"ruby-bindgen-mgn","title":"Fix cruby_name collision between global and namespaced types","description":"Global C types and namespaced C++ types can produce the same cruby_name variable:\n- `CvVideoWriter` (global C type) -\u003e `rb_cCvVideoWriter`\n- `cv::VideoWriter` (namespaced C++ class) -\u003e `rb_cCvVideoWriter`\n\n**Proposed fix**: Insert underscore between namespace prefix and class name for namespaced types:\n- `CvVideoWriter` (global) -\u003e `rb_cCvVideoWriter`\n- `cv::VideoWriter` (namespaced) -\u003e `rb_cCv_VideoWriter`\n- `cv::cuda::Stream` -\u003e `rb_cCv_Cuda_Stream`\n\n**Current workaround**: Manually rename the legacy C type variable to `rb_cCvVideoWriterLegacy` in videoio-rb.cpp after regeneration.","status":"open","priority":2,"issue_type":"bug","owner":"cfis@savagexi.com","created_at":"2026-01-27T21:08:23.456564643-08:00","created_by":"Charlie Savage","updated_at":"2026-01-27T21:08:23.456564643-08:00"}
{"id":"ruby-bindgen-n9j","title":"Support cross-file overload detection","description":"Functions like `cv::error` and `cv::randu` have overloads spread across different header files (e.g., `error` in both `base.hpp` and `core.hpp`).\n\nThe current overload detection only finds overloads within a single namespace cursor, missing cross-file overloads.\n\n**Current workaround**: Add these functions to `skip_symbols` in bindings config if they cause compilation errors like \"could not deduce template argument for 'Function_T'\".\n\nThis is a known limitation that would require tracking overloads across translation units.","status":"open","priority":3,"issue_type":"feature","owner":"cfis@savagexi.com","created_at":"2026-01-27T21:08:44.573372649-08:00","created_by":"Charlie Savage","updated_at":"2026-01-27T21:08:44.573372649-08:00"}
