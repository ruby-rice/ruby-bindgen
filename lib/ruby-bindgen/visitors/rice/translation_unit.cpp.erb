<%- includes.each do |include| -%>
<%= include %>
<%- end -%>
<%- unless incomplete_iterators.empty? -%>

// Iterator traits specializations for iterators missing std::iterator_traits
namespace std
{
<%- incomplete_iterators.each do |_, traits| -%>
  template<>
  struct iterator_traits<<%= traits[:iterator_type] %>>
  {
    using iterator_category = forward_iterator_tag;
    using value_type = <%= traits[:value_type] %>;
    using difference_type = ptrdiff_t;
    using pointer = <%= traits[:value_type] %>*;
    using reference = <%= traits[:is_const] ? "const #{traits[:value_type]}&" : "#{traits[:value_type]}&" %>;
  };

<%- end -%>
}
<%- end -%>

using namespace Rice;

<%- @classes.sort.each do |class_name, cpp_type| -%>
Rice::Data_Type<<%= cpp_type %>> <%= class_name %>;
<%- end -%>

<%= class_templates %>

void <%= init_name %>()
{
<%= content %>
}